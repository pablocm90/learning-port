<%= link_to learning_portfolio_path, class: "block hover:opacity-90 transition" do %>
  <svg class="w-full" viewBox="0 0 400 120" preserveAspectRatio="xMidYMin meet">
    <defs>
      <filter id="mini-shadow" x="-10%" y="-10%" width="120%" height="120%">
        <feDropShadow dx="1" dy="2" stdDeviation="1" flood-opacity="0.15"/>
      </filter>
    </defs>

    <g filter="url(#mini-shadow)">
      <!-- Brush stroke -->
      <path d="M 0,12
               L 350,12
               Q 375,14 388,20
               Q 396,28 394,35
               L 0,35
               Z"
            fill="var(--theme-primary)"/>

      <!-- Drips -->
      <% categories.each_with_index do |category, index| %>
        <%
          x_pos = ((index + 1) * (400.0 / (categories.count + 1))).to_i
          depth_percentage = max_depth > 0 ? (category.drip_depth / max_depth * 100) : 0
          drip_length = 40 + (depth_percentage / 100.0 * 35)

          top_w = 14
          blob_w = 10

          y_start = 32
          y_end = y_start + drip_length
        %>

        <path d="M <%= x_pos - top_w/2 %>,<%= y_start %>
                 L <%= x_pos - top_w/2 %>,<%= y_end - 20 %>
                 Q <%= x_pos - top_w/2 %>,<%= y_end - 12 %> <%= x_pos - blob_w/2 %>,<%= y_end - 8 %>
                 Q <%= x_pos - blob_w/2 - 4 %>,<%= y_end %> <%= x_pos %>,<%= y_end + 6 %>
                 Q <%= x_pos + blob_w/2 + 4 %>,<%= y_end %> <%= x_pos + blob_w/2 %>,<%= y_end - 8 %>
                 Q <%= x_pos + top_w/2 %>,<%= y_end - 12 %> <%= x_pos + top_w/2 %>,<%= y_end - 20 %>
                 L <%= x_pos + top_w/2 %>,<%= y_start %>
                 Z"
              fill="var(--theme-primary)"/>
      <% end %>
    </g>

    <!-- Category names -->
    <% categories.each_with_index do |category, index| %>
      <%
        x_pos = ((index + 1) * (400.0 / (categories.count + 1))).to_i
        depth_percentage = max_depth > 0 ? (category.drip_depth / max_depth * 100) : 0
        drip_length = 40 + (depth_percentage / 100.0 * 35)
        y_end = 32 + drip_length
      %>
      <text x="<%= x_pos %>" y="<%= y_end + 18 %>"
            text-anchor="middle"
            class="fill-current text-muted"
            style="font-size: 9px; font-weight: 500;">
        <%= truncate(category.name, length: 12) %>
      </text>
    <% end %>
  </svg>
<% end %>
