<%= link_to learning_portfolio_path, class: "block hover:opacity-90 transition" do %>
  <svg class="w-full" viewBox="0 0 400 150" preserveAspectRatio="xMidYMin meet">
    <defs>
      <linearGradient id="mini-paint-gradient" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color: var(--theme-primary); stop-opacity: 1;" />
        <stop offset="100%" style="stop-color: var(--theme-primary); stop-opacity: 0.7;" />
      </linearGradient>
      <filter id="mini-paint-texture" x="-5%" y="-5%" width="110%" height="110%">
        <feTurbulence type="fractalNoise" baseFrequency="0.05" numOctaves="2" result="noise"/>
        <feDisplacementMap in="SourceGraphic" in2="noise" scale="2" xChannelSelector="R" yChannelSelector="G"/>
      </filter>
    </defs>

    <!-- Brush stroke band -->
    <path d="M 0,12
             Q 50,5 100,15
             Q 150,8 200,12
             Q 250,6 300,14
             Q 350,9 400,10
             L 400,28
             Q 350,26 300,30
             Q 250,27 200,32
             Q 150,28 100,30
             Q 50,27 0,30
             Z"
          fill="url(#mini-paint-gradient)"
          filter="url(#mini-paint-texture)"/>

    <!-- Drips -->
    <% categories.each_with_index do |category, index| %>
      <%
        x_pos = ((index + 1) * (400.0 / (categories.count + 1))).to_i
        depth_percentage = max_depth > 0 ? (category.drip_depth / max_depth * 100) : 0
        min_drip = 25
        max_drip = 90
        drip_length = min_drip + (depth_percentage / 100.0 * (max_drip - min_drip))
        drip_w = 14 + (index % 2) * 2
        half_w = drip_w / 2
        y_start = 26
        y_end = y_start + drip_length
      %>

      <!-- Drip -->
      <path d="M <%= x_pos - half_w %>,<%= y_start %>
               Q <%= x_pos - half_w - 1 %>,<%= y_start + drip_length * 0.5 %> <%= x_pos - half_w + 2 %>,<%= y_end - 8 %>
               Q <%= x_pos %>,<%= y_end + 5 %> <%= x_pos + half_w - 2 %>,<%= y_end - 8 %>
               Q <%= x_pos + half_w + 1 %>,<%= y_start + drip_length * 0.5 %> <%= x_pos + half_w %>,<%= y_start %>
               Z"
            fill="url(#mini-paint-gradient)"
            filter="url(#mini-paint-texture)"
            style="opacity: <%= 0.8 + (depth_percentage / 100.0 * 0.2) %>;"/>

      <!-- Category name -->
      <text x="<%= x_pos %>" y="<%= y_end + 20 %>"
            text-anchor="middle"
            class="fill-current text-muted"
            style="font-size: 9px; font-weight: 500;">
        <%= truncate(category.name, length: 12) %>
      </text>
    <% end %>
  </svg>
<% end %>
