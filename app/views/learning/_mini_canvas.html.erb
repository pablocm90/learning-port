<%= link_to learning_portfolio_path, class: "block hover:opacity-90 transition" do %>
  <svg class="w-full" viewBox="0 0 400 130" preserveAspectRatio="xMidYMin meet">
    <defs>
      <linearGradient id="mini-paint-gradient" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color: var(--theme-primary); stop-opacity: 1;" />
        <stop offset="70%" style="stop-color: var(--theme-primary); stop-opacity: 0.95;" />
        <stop offset="100%" style="stop-color: var(--theme-primary); stop-opacity: 0.85;" />
      </linearGradient>
      <linearGradient id="mini-gloss" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color: white; stop-opacity: 0.35;" />
        <stop offset="50%" style="stop-color: white; stop-opacity: 0;" />
      </linearGradient>
    </defs>

    <!-- Wet brush stroke -->
    <path d="M 0,10
             Q 50,18 100,12
             Q 200,22 300,14
             Q 350,20 400,15
             L 400,30
             Q 350,28 300,32
             Q 200,30 100,34
             Q 50,32 0,30
             Z"
          fill="url(#mini-paint-gradient)"/>

    <!-- Brush stroke gloss -->
    <path d="M 0,13
             Q 50,19 100,15
             Q 200,23 300,17
             Q 350,21 400,18
             L 400,22
             Q 350,20 300,23
             Q 200,22 100,25
             Q 50,23 0,24
             Z"
          fill="url(#mini-gloss)"/>

    <!-- Drips -->
    <% categories.each_with_index do |category, index| %>
      <%
        x_pos = ((index + 1) * (400.0 / (categories.count + 1))).to_i
        depth_percentage = max_depth > 0 ? (category.drip_depth / max_depth * 100) : 0
        min_drip = 40
        max_drip = 80
        drip_length = min_drip + (depth_percentage / 100.0 * (max_drip - min_drip))

        # Scaled dimensions for mini version
        neck_w = 8
        mid_w = 12
        blob_w = 15

        y_start = 28
        y_neck = y_start + 10
        y_mid = y_start + drip_length * 0.5
        y_bulge = y_start + drip_length * 0.75
        y_blob_top = y_start + drip_length - 12
        y_end = y_start + drip_length
      %>

      <!-- Drip with rounded blob bottom -->
      <path d="M <%= x_pos - neck_w/2 %>,<%= y_start %>
               L <%= x_pos - neck_w/2 %>,<%= y_neck %>
               Q <%= x_pos - mid_w/2 - 1 %>,<%= y_mid - 8 %> <%= x_pos - mid_w/2 %>,<%= y_mid %>
               Q <%= x_pos - mid_w/2 + 1 %>,<%= y_bulge - 4 %> <%= x_pos - blob_w/2 %>,<%= y_bulge %>
               Q <%= x_pos - blob_w/2 - 2 %>,<%= y_blob_top %> <%= x_pos - blob_w/2 + 1 %>,<%= y_blob_top + 4 %>
               Q <%= x_pos - blob_w/3 %>,<%= y_end + 4 %> <%= x_pos %>,<%= y_end + 6 %>
               Q <%= x_pos + blob_w/3 %>,<%= y_end + 4 %> <%= x_pos + blob_w/2 - 1 %>,<%= y_blob_top + 4 %>
               Q <%= x_pos + blob_w/2 + 2 %>,<%= y_blob_top %> <%= x_pos + blob_w/2 %>,<%= y_bulge %>
               Q <%= x_pos + mid_w/2 - 1 %>,<%= y_bulge - 4 %> <%= x_pos + mid_w/2 %>,<%= y_mid %>
               Q <%= x_pos + mid_w/2 + 1 %>,<%= y_mid - 8 %> <%= x_pos + neck_w/2 %>,<%= y_neck %>
               L <%= x_pos + neck_w/2 %>,<%= y_start %>
               Z"
            fill="url(#mini-paint-gradient)"/>

      <!-- Category name -->
      <text x="<%= x_pos %>" y="<%= y_end + 18 %>"
            text-anchor="middle"
            class="fill-current text-muted"
            style="font-size: 9px; font-weight: 500;">
        <%= truncate(category.name, length: 12) %>
      </text>
    <% end %>
  </svg>
<% end %>
